import pandas as pd
import numpy as np

data = pd.read_csv("C:\Users\mathe\Desktop\dm\Preprocessed_data\\2015-2016_merged-csv_mod.csv")
df=pd.DataFrame(data)

df["EG.ELC.ACCS.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SE.PRM.TENR"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["NY.ADJ.NNTY.KD.ZG"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
#df["NY.ADJ.NNTY.PC.KD.ZG"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["NY.ADJ.AEDU.GN.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["NY.ADJ.ICTR.GN.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SP.POP.DPND"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SP.DYN.CBRT.IN"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SP.DYN.CDRT.IN"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
#df["SE.XPD.PRIM.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SE.XPD.SECO.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["GC.XPN.TOTL.GD.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SH.XPD.EHEX.CH.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["NY.GDP.MKTP.CD"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["NY.GDP.MKTP.KD.ZG"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["NY.GDS.TOTL.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SE.ADT.1524.LT.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
#df["NV.IND.MANF.KD.ZG"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SH.DYN.NMRT"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SH.DYN.MORT"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
#df["SP.POP.TOTL"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SE.SEC.ENRL.TC.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SE.PRM.ENRL.TC.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["EG.FEC.RNEW.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["AG.SRF.TOTL.K2"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["GC.TAX.TOTL.GD.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["NE.TRD.GNFS.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
df["SL.UEM.TOTL.NE.ZS"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))
#df["FP.WPI.TOTL"] = df.groupby(["Country Name","Year"]).transform(lambda x: x.fillna(x.mean()))

df.to_csv("cleaned1516.csv")